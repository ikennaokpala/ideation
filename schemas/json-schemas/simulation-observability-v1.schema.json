{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://sparc-dsl.dev/schemas/simulation-observability-v1.schema.json",
  "title": "Simulation observability contract (v1)",
  "description": "Contract for operational event taxonomy (traces/spans) and metrics windows (Sprint 6).",
  "type": "object",
  "additionalProperties": true,
  "required": ["$schema", "schema", "version", "services", "metrics"],
  "properties": {
    "$schema": { "type": "string" },
    "schema": { "const": "simulation_observability_v1" },
    "version": { "type": "string", "pattern": "^\\d+\\.\\d+(\\.\\d+)?$" },
    "services": { "type": "array", "items": { "$ref": "#/definitions/service" }, "minItems": 1 },
    "operations": { "type": "array", "items": { "$ref": "#/definitions/operation" } },
    "fault_injection": { "type": "array", "items": { "type": "object" } },
    "metrics": { "type": "array", "items": { "$ref": "#/definitions/metric" }, "minItems": 1 }
  },
  "definitions": {
    "service": {
      "type": "object",
      "additionalProperties": true,
      "required": ["service"],
      "properties": {
        "service": { "type": "string", "minLength": 1 },
        "description": { "type": "string" }
      }
    },
    "operation": {
      "type": "object",
      "additionalProperties": true,
      "required": ["operation"],
      "properties": {
        "operation": { "type": "string", "minLength": 1 },
        "service": { "type": "string" },
        "kind": { "type": "string" }
      }
    },
    "metric": {
      "type": "object",
      "additionalProperties": true,
      "required": ["metric_id", "definition"],
      "properties": {
        "metric_id": { "type": "string", "minLength": 1 },
        "definition": { "type": "string" },
        "unit": { "type": "string" },
        "window": { "type": "string" },
        "derived_from": { "type": "array", "items": { "type": "string" } }
      }
    }
  }
}

